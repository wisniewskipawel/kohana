{"version":3,"sources":["admin-reviewer.admin.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"reviewer.admin.min.js","sourcesContent":["/**\n * Reviewer Plugin v.3.4\n * Created by Michele Ivani\n */\njQuery(document).ready(function( $ ){\n\n\tfunction getDecimals(number) {\n\t\tvar num = parseFloat(number);\n        var match = ('' + num).match(/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/);\n        if (!match)\n            return 0;\n        return Math.max(0, (match[1] ? match[1].length : 0) - (match[2] ? +match[2] : 0));\n    }\n\n    var codeMirrorTextarea = document.getElementById( \"rwp-codemirror\" );\n\n    if( codeMirrorTextarea !== null ) \n    {\n    \tvar editor = CodeMirror.fromTextArea( codeMirrorTextarea, {\n    \t\tlineNumbers: true, \n    \t\tlineWrapping: true, \n    \t\ttheme: 'neo',\n    \t\tvalue: codeMirrorTextarea.value,\n    \t\tindentUnit: 4,\n    \t\tindentWithTabs: true,\n    \t});\n\t}\n\t//console.log(isTemplateManagerObj);\n\t\n\t// Add criteria input\n\t$('#rwp-add-criteria-btn').click(function(e){\n\t\te.preventDefault();\n\t\tvar criteria = $('#rwp-criterias');\n\t\tvar inputPlaceholder = criteria.data('placeholder');\n\t\tvar removeLabel = criteria.data('remove-label');\n\t\tvar i = criteria.find('li').length;\n\t\tvar criteriaInput = '<li><span class=\"dashicons dashicons-menu\"></span><input type=\"text\" name=\"rwp_templates[template_criterias]['+i+']\" value=\"\" placeholder=\"'+ inputPlaceholder +'\" /> <a class=\"rwp-remove-criteria-btn\" href=\"#\">'+ removeLabel +'</a></li>';\n\t\t\n\t\t$('#rwp-criterias').append(criteriaInput);\n\t});\n\n\t// Remove criteria input\n\t$('.wrap').on('click', '.rwp-remove-criteria-btn', function(e){\n\t\te.preventDefault();\n\t\t//console.log('asd');\n\t\t$(this).parent().remove();\n\t});\n\n\t// Add cutom tab\n\t$('#rwp-add-custom-tab-btn').click(function(e){\n\t\te.preventDefault();\n\t\tvar tabs \t= $('#rwp-custom-tabs');\n\t\tvar lastLi\t= tabs.find('li').last();\n\t\tvar opts \t= tabs.data('ajax');\n\n\t\tvar i = 0;\n\n\t\tif( lastLi.length != 0 ) {\n\t\t\ti = parseInt(lastLi.data('i')) + 1;\n\t\t} \n\n\t\tconsole.log(lastLi);\n\n\t\tvar html = '';\n\n\t\thtml += '<li data-i=\"'+i+'\">';\n\n\t\t\t$.each(opts.formFields, function( index, key ) {\n\n\t\t\t\t//if( $.inArray( key, opts.optionsKeys ) == -1 ) skip;\n\n\t\t\t\tvar c = c = ( key == 'tab_color' ) ? 'class=\"rwp-color-picker\"' : '';\n\n\t\t\t\thtml += '<span>';\n\t\t\t\t\thtml += '<label>'+ opts.options[key].label +'</label>';\n\t\t\t\t\thtml += '<input type=\"text\" name=\"'+ opts.optionName +'[' + opts.fieldId + ']['+ i +'][' + key + ']\" value=\"\" placeholder=\"'+ opts.options[key].default +'\" '+ c +' />';\n\t\t\t\thtml += '</span>';\n\t\t\t  \t\n\n\t\t\t});\n\n\t\t\thtml += '<span><a class=\"rwp-remove-tab-btn\" href=\"#\">'+ opts.removeLabel +'</a></span>';\n\n\t\thtml += '</li>';\n\n\t\ttabs.append(html);\n\t\t\n\t\t$('.rwp-color-picker').wpColorPicker();\n\t});\n\n\t// Remove custom tab\n\t$('.wrap').on('click', '.rwp-remove-tab-btn', function(e){\n\t\te.preventDefault();\n\t\t$(this).parent().parent().remove();\n\t});\n\t\n\n\t// Trigg WP color picker\n\t$('.rwp-color-picker').wpColorPicker();\n\n\t// Trigg jQuery UI Sortable\n\t$('#rwp-criterias').sortable();\n\t//$('#rwp-criterias').disableSelection();\n\n\t// Don't enable to exclude all categories\n\t$('.wrap').on('change', '.rwp-exclude-terms input', function(e){\n\t\te.preventDefault();\n\t\tvar ul \t\t= $(this).closest('ul'),\n\t\t\tliCount = ul.find('input').length,\n\t\t\tliCheck = ul.find('input:checked').length,\n\t\t\tmes \t= ul.parent().find('.rwp-terms-msg'),\n\t\t\tm \t\t= ul.data('msg');\n\n\t\t\tmes.html('');\n\t\t\tif( liCount == liCheck ) {\n\t\t\t\t$(this).attr('checked', false);\n\t\t\t\tmes.html(m);\n\t\t\t}\n\t});\n\n\t// === Prefereces ===\n\t\n\tif ( $('#rwp-pref-form') != null) {\n\t\ttrigLimitsSliders();\n\t\ttrigStdSliders();\n\t}\n\n\tfunction trigStdSliders() {\n\n\t\t$('.rwp-slider-std').each(function(i){\n\n\t\t\t$(this).noUiSlider({\n\t            step: 1,\n\t            start: $(this).data('val'),\n\t            connect: \"lower\",\n\t            range: {\n\t              'min': $(this).data('min'),\n\t              'max': $(this).data('max')\n\t            },\n\t            format: wNumb({\n\t                decimals: 0,\n\t            })\n\t        });\n\n\t        $(this).Link('lower').to($(this).parent().find('input'), null, wNumb({decimals: 0 }));\n\n\n\t    });\n\n\t}\n\n\tfunction trigLimitsSliders() {\n\n\t\t$('.rwp-slider-limits').each(function(i){\n\n\t\t\tvar mi = $(this).data('min');\n\t\t\tvar ma = $(this).data('max');\n\n\t\t\tma = (ma == 'inf') ? 10000 : ma;\n\t\t\t\n\t\t\t$(this).noUiSlider({\n\t\t\t\tconnect: true,\n\t\t\t\tstep: 1,\n\t\t\t\tstart: [ mi, ma ],\n\t\t\t\trange: {\n\t\t\t\t\t// Starting at 500, step the value by 500,\n\t\t\t\t\t// until 4000 is reached. From there, step by 1000.\n\t\t\t\t\t'min': [ 0 ],\n\t\t\t\t\t'90%': 5000,\n\t\t\t\t\t'max': 10000\n\t\t\t\t},\n\t\t\t\tformat: wNumb({\n\t                decimals: 0\n\t            })\n\t\t\t});\n\n\t        $(this).Link('lower').to($(this).parent().find('input.rwp-min'), null, wNumb({decimals: 0 }));\n\t        $(this).Link('upper').to($(this).parent().find('input.rwp-max'), null, wNumb({decimals: 0 }));\n\n\t        $(this).on({\n\t\t\t\tslide: function(){\n\n\t\t\t\t\tvar min = $(this).val()[0];\n\t\t\t\t\tvar max = $(this).val()[1];\n\t\t\t\t\t\n\t\t\t\t\tif( max > 5000 ) {\n\t\t\t\t\t\t$(this).parent().find('input.rwp-max').val('no-limit');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t        if( ma > 5000 ) {\n\t\t\t\t$(this).parent().find('input.rwp-max').val('no-limit');\n\t\t\t}\n\n\t    });\n\n\t}\n\n\n\t// Send demo notification\n\t$('#rwp-notification-btn').click(function(e){\n\t\te.preventDefault();\n\n\t\tvar email = $.trim( $(this).parent().find('input[type=text]').val() );\n\n\t\tif( email.length == 0 || !isEmail(email) ) {\n\t\t\talert('Insert a valid email address');\n\t\t\treturn false;\n\t\t}\n\n\t\tvar loader = $(this).parent().find('.rwp-loader');\n\n\t\tvar postData = {\n\t\t\taction: demoNotificationDataObj.action,\n\t\t\tsecurity: demoNotificationDataObj.ajax_nonce,\n\t\t\temail: email,\n\t\t}\n\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\n\t\t$.post(demoNotificationDataObj.ajax_url, postData, function(response){\n\t\t\t\n\t\t\tloader.fadeOut('fast');\n\t\t\talert(response.data.msg);\n\n\t\t}, 'json').fail(function(){\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t\talert('Error sending email. Retry or contact the plugin support team. Thank You.');\n\t\t});\n\n\n\t});\n\n\n\tfunction isEmail(email) {\n\t    var filter = /^([a-zA-Z0-9_.+-])+\\@(([a-zA-Z0-9-])+\\.)+([a-zA-Z0-9]{2,4})+$/;\n  \t\treturn filter.test(email);\n\t}\n\n\t// === Reviewies Meta Box ===\n\n\t// Show scores about first template\n\tfunction showScoresAboutFirstTemplate(reviewId) {\n\t\t$('.rwp-t-scores-'+ reviewId).first().show();\n\t\t$('.rwp-t-custom-tabs-'+ reviewId).first().show();\n\t}\n\n\t// Select correct tab\n\tfunction selectCorretTab(reviewId) {\n\t\t// Link Tab\n\t\t$( \"#rwp-reviews-meta-box .rwp-tabs-wrap\" ).children('li').each(function(i){\n\t\t\t$(this).removeClass('rwp-tabs');\n\t\t});\n\n\t\t$('#rwp-review-tab-'+ reviewId).addClass('rwp-tabs');\n\n\t\t// Review Panel\n\t\t$( \"#rwp-reviews-wrap\" ).children('.rwp-review-form').each(function(i){\n\t\t\t$(this).hide();\n\t\t});\n\n\t\t$('#rwp-review-'+ reviewId).show();\n\t}\n\n\tfunction trigSliders(reviewId) {\n\n\t\tvar step \t\t= ( typeof rwpPreferences.preferences_step !== \"undefined\" ) ? parseFloat(rwpPreferences.preferences_step) : .5;\n\t\tvar decimals \t= getDecimals(step);\n\t\tvar elem \t\t= ( reviewId == null ) ? '.rwp-slider' : '#rwp-review-' + reviewId + ' .rwp-slider'; \n\n\t\t$(elem).each(function(i){\n\t\t\t\n\t\t\t$(this).noUiSlider({\n\t            step: step,\n\t            start: $(this).data('val'),\n\t            connect: \"lower\",\n\t            range: {\n\t              'min': $(this).data('min'),\n\t              'max': $(this).data('max')\n\t            },\n\t            format: wNumb({\n\t                decimals: decimals,\n\t                //thousand: '.',\n\t                //postfix: ' (US $)',\n\t            })\n\t        });\n\n\t        $(this).Link('lower').to($(this).parent().find('input'), null, wNumb({decimals: decimals }));\n\n\n\t    });\n\t}\n\n\n\tif ( $('#rwp-reviews-meta-box') != null) {\n\t\ttrigSliders(null);\n\t}\n\n\t// On template change\n\t$('#rwp-reviews-meta-box').on('change','.rwp-template-selection', function(){\n\t\tvar reviewId = $(this).data('review-id');\n\t\tvar templateId = $(this).val();\n\n\t\t$('.rwp-t-scores-' + reviewId ).hide();\n\t\t$('#rwp-template-scores-'+ reviewId +'-'+ templateId).show();\n\n\t\t$('.rwp-t-custom-tabs-' + reviewId ).hide();\n\t\t$('#rwp-custom-tabs-'+ reviewId +'-'+ templateId).show();\n\t});\n\n\t// On review tab click\n\t$('#rwp-reviews-meta-box').on('click','.rwp-tabs-wrap li a', function(e){\n\t\te.preventDefault();\n\t\tvar reviewId = $(this).data('review-id');\n\t\tselectCorretTab(reviewId);\n\t});\n\n\t// Delete review\n\t$('#rwp-reviews-meta-box').on('click','.rwp-delete-review-btn', function(e){\n\t\te.preventDefault();\n\t\tvar reviewId = $(this).data('review-id');\n\t\t$('#rwp-review-'+ reviewId).remove();\n\t\t$('#rwp-review-tab-'+ reviewId).remove();\n\n\t\tvar lastId = $('.rwp-review-form').last().data('review-id');\n\t\tselectCorretTab(lastId);\n\t});\n\n\t// Remove Image\n\t$('#rwp-reviews-meta-box').on('click','.rwp-review-remove-image-btn', function(e){\n\t\te.preventDefault();\n\t\tvar reviewId = $(this).data('review-id');\n\t\tvar defaultUrl = $(this).data('default');\n\t\t$('#rwp-review-image-img-'+reviewId).attr('src', defaultUrl);\n\t\t$('#rwp-review-add-image-input-'+reviewId).val('');\n\t});\n\n\n\t// Load form for new review\n\t$('#rwp-add-review-form-btn').click(function(e){\n\t\te.preventDefault();\n\n\t\tvar reviewId = 0;\n\t\tvar placeholder = $('#rwp-reviews-meta-box .rwp-tabs-wrap').data('placehoder');\n\t\tvar lastId = $('.rwp-review-form').last().data('review-id');\n\t\tvar loader = $(this).parent().find('.rwp-loader');\n\n\t\tvar reviewType = $(this).parent().find('select[name=rwp-review-type]').val();\n\n\t\tif (lastId != null) {\n\t\t\treviewId = parseInt(lastId) + 1;\n\t\t}\n\n\t\tvar postData = {\n\t\t\taction \t\t\t: reviewsMetaBoxObj.action,\n\t\t\tsecurity \t\t: reviewsMetaBoxObj.ajax_nonce,\n\t\t\trwp_review_id\t: reviewId,\n\t\t\trwp_review_type\t: reviewType\n\t\t}\n\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\n\t\t$.post(reviewsMetaBoxObj.ajax_url, postData, function(data){\n\n\t\t\t// Add new form\n\t\t\t$('#rwp-reviews-wrap').append(data);\n\n\t\t\t// Add Tab\n\t\t\t$('#rwp-reviews-meta-box .rwp-tabs-wrap').append('<li class=\"rwp-tabs\" id=\"rwp-review-tab-'+ reviewId +'\"><a href=\"#\" data-review-id=\"'+ reviewId +'\">'+ placeholder +' ' + reviewId+ '</a></li>');\n\n\t\t\t// Show scores about first template\n\t\t\tshowScoresAboutFirstTemplate(reviewId);\n\n\t\t\t// Select corret tab\n\t\t\tselectCorretTab(reviewId);\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t\t// Trig sliders\n\t\t\ttrigSliders(reviewId);\n\n\t\t\t// // Trig pros and cons\n\t\t\t// trigWPEditor(reviewId);\n\n\t\t\t//console.log(tinymce);\n\n\t\t\t//tinymce.createEditor('rwp_editor_rwp_reviews_'+reviewId+'_review_pros');\n\t\t\t//tinymce.init(tinyMCEPreInit.mceInit['rwp_editor_rwp_reviews_'+reviewId+'_review_cons']);\n\n\t\t\n\t\t}).fail(function(){\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t\talert('Error getting review form. Retry or contact the plugin support team. Thank You.');\n\t\t});\n\n\t});\n\n\n\t// Custom links add\n\t$('#rwp-reviews-meta-box').on('click','.rwp-add-custom-link-btn', function(e){\n\t\te.preventDefault();\n\t\tvar reviewId = $(this).data('review-id');\n\t\tvar linkId = 0;\n\n\t\tvar lastId = $(this).parent().find('li').last().data('id');\n\t\tif (lastId != null) {\n\t\t\tlinkId = parseInt(lastId) + 1;\n\t\t}\n\n\t\tvar UL = $(this).parent().find('.rwp-custom-links'); \n\n\t\tvar html = '<li data-id=\"'+linkId+'\">';\n\t\t\thtml += '<input type=\"text\" name=\"rwp_reviews[0][review_custom_links]['+linkId+'][label]\"\tvalue=\"\" placeholder=\"'+ UL.data('label-placeholder') +'\">';\n\t\t\thtml += '<input type=\"text\" name=\"rwp_reviews[0][review_custom_links]['+linkId+'][url]\" \tvalue=\"\" placeholder=\"'+ UL.data('url-placeholder') +'\">';\n\t\t\thtml += '<a href=\"#\" class=\"rwp-delete-custom-link-btn\">'+ UL.data('remove-placeholder') +'</a>';\n\t\t\thtml += '</li>';\n\n\t\tUL.append(html);\n\t});\n\n\t// Custom links remove\n\t$('#rwp-reviews-meta-box').on('click','.rwp-delete-custom-link-btn', function(e){\n\t\te.preventDefault();\n\t\t$(this).parent().remove();\n\t});\n\n\t// Review Title Input\n\t$('#rwp-reviews-meta-box').on('keyup','.rwp-review-title-input', function(e){\n\t\te.preventDefault();\n\t\tvar reviewId \t= $(this).data('review-id');\n\t\tvar def \t\t= $(this).data('default');\n\t\tvar v \t\t\t= $(this).val();\n\n\t\tvar out = ( v == '' ) ? def : v; \n\n\t\t$('#rwp-review-tab-'+ reviewId + ' a').html( out );\n\t});\n\n\t// === Tables Meta Box ===\n\n\t// Show reviews about first template\n\tfunction showReviewsAboutFirstTemplate(tableId) {\n\t\t$('.rwp-t-reviews-'+ tableId).first().show();\n\t}\n\n\t// Select correct tab\n\tfunction selectCorretTableTab(tableId) {\n\t\t// Link Tab\n\t\t$( \"#rwp-tables-meta-box .rwp-tabs-wrap\" ).children('li').each(function(i){\n\t\t\t$(this).removeClass('rwp-tabs');\n\t\t});\n\n\t\t$('#rwp-table-tab-'+ tableId).addClass('rwp-tabs');\n\n\t\t// Table Panel\n\t\t$( \"#rwp-tables-wrap\" ).children('.rwp-table-form').each(function(i){\n\t\t\t$(this).hide();\n\t\t});\n\n\t\t$('#rwp-table-'+ tableId).show();\n\t}\n\n\t// On template change\n\t$('#rwp-tables-meta-box').on('change','.rwp-template-selection', function(){\n\t\tvar tableId = $(this).data('table-id');\n\t\tvar templateId = $(this).val();\n\n\t\t$('.rwp-t-reviews-' + tableId ).hide();\n\t\t$('#rwp-template-reviews-'+ tableId +'-'+ templateId).show();\n\t});\n\n\t// On table tab click\n\t$('#rwp-tables-meta-box').on('click','.rwp-tabs-wrap li a', function(e){\n\t\te.preventDefault();\n\t\tvar tableId = $(this).data('table-id');\n\t\tselectCorretTableTab(tableId);\n\t});\n\n\t// Delete review\n\t$('#rwp-tables-meta-box').on('click','.rwp-delete-table-btn', function(e){\n\t\te.preventDefault();\n\t\tvar tableId = $(this).data('table-id');\n\t\t$('#rwp-table-'+ tableId).remove();\n\t\t$('#rwp-table-tab-'+ tableId).remove();\n\n\t\tvar lastId = $('.rwp-table-form').last().data('table-id');\n\t\tselectCorretTableTab(lastId);\n\t});\n\n\t// Load form for new review\n\t$('#rwp-add-table-form-btn').click(function(e){\n\t\te.preventDefault();\n\n\t\tvar tableId = 0;\n\t\tvar placeholder = $('#rwp-tables-meta-box .rwp-tabs-wrap').data('placehoder');\n\t\tvar lastId = $('.rwp-table-form').last().data('table-id');\n\t\tvar loader = $(this).parent().find('.rwp-loader');\n\n\t\tif (lastId != null) {\n\t\t\ttableId = parseInt(lastId) + 1;\n\t\t}\n\n\t\tvar postData = {\n\t\t\taction: tablesMetaBoxObj.action,\n\t\t\tsecurity: tablesMetaBoxObj.ajax_nonce,\n\t\t\trwp_table_id: tableId\n\t\t}\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\t\t\n\t\t$.post(tablesMetaBoxObj.ajax_url, postData, function(data){\n\n\t\t\t// Add new form\n\t\t\t$('#rwp-tables-wrap').append(data);\n\n\t\t\t// Add Tab\n\t\t\t$('#rwp-tables-meta-box .rwp-tabs-wrap').append('<li class=\"rwp-tabs\" id=\"rwp-table-tab-'+ tableId +'\"><a href=\"#\" data-table-id=\"'+ tableId +'\">'+ placeholder +'</a></li>');\n\n\t\t\t// Show scores about first template\n\t\t\tshowReviewsAboutFirstTemplate(tableId);\n\n\t\t\t// Select corret tab\n\t\t\tselectCorretTableTab(tableId);\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t}).fail(function(){\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t\talert('Error getting table form. Retry or contact the plugin support team. Thank You.');\n\t\t});\n\n\t});\n\n\t// Tbale Title Input\n\t$('#rwp-tables-meta-box').on('keyup','.rwp-table-title-input', function(e){\n\t\te.preventDefault();\n\t\tvar tableId \t= $(this).data('table-id');\n\t\tvar def \t\t= $(this).data('default');\n\t\tvar v \t\t\t= $(this).val();\n\n\t\tvar out = ( v == '' ) ? def : v; \n\n\t\t$('#rwp-table-tab-'+ tableId + ' a').html( out );\n\t});\n\n\n\t// Themes tooltip\n\t$('.rwp-theme-name').tooltip({\n\t\ttrack: true,\n\t\ttooltipClass: 'rwp-tooltip',\n\t\tcontent: function () {\n\t\t\treturn '<img src=\"'+ $(this).data('preview') +'\" height=\"400px\" />';\n\t\t}\n\n\t});\n\n\n\t// Restore default rating image\n\t$('#rwp-rating-image-btn-default').click(function(e) {\n\t\te.preventDefault();\n\t\tvar defaultUrl = $(this).data('default');\n\t\t$('#rwp-rating-image-url').val(defaultUrl);\n\t    $('#rwp-rating-image').attr('src', defaultUrl);\n\t});\n\n\n\t// Deleting template \n\t$('.themes').on('click', '.rwp-delete-template-btn', function(e){\n\t\te.preventDefault();\n\t\tvar templateId = $(this).data('template-id');\n\t\tvar confirmMsg = $(this).data('confirm-msg');\n\t\t\n\t\tvar res = confirm(confirmMsg);\n\t\t\n\t\tif ( res != true)\n\t\t\treturn false;\n\n\t\t//console.log(templateId);\n\n\t\tvar loader = $('.wrap').find('.rwp-loader');\n\n\t\tvar postData = {\n\t\t\taction: deleteTemplateObj.action,\n\t\t\tsecurity: deleteTemplateObj.ajax_nonce,\n\t\t\ttemplateId : templateId \n\t\t}\n\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\n\t\t$.post(deleteTemplateObj.ajax_url, postData, function(data){\n\n\t\t\t//console.log(data);\n\n\t\t\t$('#rwp-theme-wrap-'+templateId).fadeOut('fast', function() {\n\t\t\t\t$(this).remove();\n\t\t\t});\n\t\t\t\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t}, 'json').fail(function(){\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t\talert('Error deleting template. Retry or contact the plugin support team. Thank You.');\n\t\t});\n\t\t\n\t});\n\n\n\t// Duplicate template \n\t$('.themes').on('click', '.rwp-duplicate-template-btn', function(e){\n\t\te.preventDefault();\n\t\tvar templateId = $(this).data('template-id');\n\t\t\n\t\tvar loader = $('.wrap').find('.rwp-loader');\n\n\t\tvar postData = {\n\t\t\taction: duplicateTemplateObj.action,\n\t\t\tsecurity: duplicateTemplateObj.ajax_nonce,\n\t\t\ttemplateId : templateId \n\t\t}\n\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\n\t\t$.post(duplicateTemplateObj.ajax_url, postData, function(data){\n\n\t\t\tif( typeof( data.html ) !== 'undefined') {\n\n\t\t\t\tvar last = $('.theme.add-new-theme');\n\t\t\t\tvar container = $('.themes');\n\n\t\t\t\tlast.remove();\n\t\t\t\tcontainer.append(data.html).append(last);\n\t\t\t\t//alert(data.msg);\n\t\t\t}\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t}, 'json').fail(function(){\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t\talert('Error duplicating template. Retry or contact the plugin support team. Thank You.');\n\t\t});\n\t\t\n\t});\n\n\t//$('.rwp-theme-name' ).tooltip( \"open\" );\n\n\t// Restore Data\n\t$('#rwp-restore-data-btn').click(function(e){\n\t\te.preventDefault();\n\t\tvar confirmMsg = $(this).data('confirm-msg');\n\t\t\n\t\tvar res = confirm(confirmMsg);\n\n\t\tif ( res != true) \n\t\t\treturn false;\n\n\t\tvar loader = $(this).parent().find('.rwp-loader');\n\n\t\tvar postData = {\n\t\t\taction: restoreDataObj.action,\n\t\t\tsecurity: restoreDataObj.ajax_nonce,\n\t\t}\n\t\t\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\n\t\t$.post(restoreDataObj.ajax_url, postData, function(data){\n\n\t\t\t//console.log(data);\n\n\t\t\t$('#rwp-restore-data-notification p strong').html(data.msg);\n\t\t\t$('#rwp-restore-data-notification').slideDown('fats');\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t}, 'json').fail(function(){\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t\talert('Error restoring data. Retry or contact the plugin support team. Thank You.');\n\t\t});\n\n\t});\n\n\t// Reset Score\n\t$('.rwp-reset-score-btn').click(function(e){\n\t\te.preventDefault();\n\t\tvar confirmMsg = $(this).data('confirm-msg');\n\t\tvar resMsg = $(this).data('res-msg');\n\t\tvar reviewId = $(this).data('review-id');\n\t\tvar postId = $(this).data('post-id');\n\t\tvar res = confirm(confirmMsg);\n\t\tvar ref = $(this);\n\n\t\tif ( res != true) \n\t\t\treturn false;\n\n\t\tvar loader = $(this).parent().find('.rwp-loader');\n\n\t\tvar postData = {\n\t\t\taction: resetScoreObj.action,\n\t\t\tsecurity: resetScoreObj.ajax_nonce,\n\t\t\treviewId: reviewId,\n\t\t\tpostId: postId\n\t\t}\n\t\t\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\n\t\t$.post(resetScoreObj.ajax_url, postData, function(data){\n\n\t\t\t//console.log(data);\n\n\t\t\tref.parent().parent().find('.rwp_reviews_table_review_users_score').html(resMsg);\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t}).fail(function(){\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t\talert('Error resetting score. Retry or contact the plugin support team. Thank You.');\n\t\t});\n\n\t});\n\n\t// Delete single review\n\t$('.rwp-delete-single-review-btn').click(function(e){\n\t\te.preventDefault();\n\t\tvar confirmMsg = $(this).data('confirm-msg');\n\t\tvar resMsg = $(this).data('res-msg');\n\t\tvar reviewId = $(this).data('review-id');\n\t\tvar postId = $(this).data('post-id');\n\t\tvar res = confirm(confirmMsg);\n\t\tvar ref = $(this);\n\n\t\tif ( res != true) \n\t\t\treturn false;\n\n\t\tvar loader = $(this).parent().find('.rwp-loader');\n\n\t\tvar postData = {\n\t\t\taction: deleteReviewObj.action,\n\t\t\tsecurity: deleteReviewObj.ajax_nonce,\n\t\t\treviewId: reviewId,\n\t\t\tpostId: postId\n\t\t}\n\t\t\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\n\t\t$.post(deleteReviewObj.ajax_url, postData, function(response){\n\n\t\t\t// Hide loader\n\t\t\tloader.fadeOut('fast');\n\n\t\t\tswitch( response.code ) {\n\n                case 400:\n\n                    loader.fadeOut('fast');\n                    alert( response.data.msg );\n                    break;\n\n                case 200:\n\n                    ref.parent().parent().remove();\n                    alert( resMsg );\n                    break;\n\n                default:\n                    //console.log(response);\n                    alert('Error in deleting process!');\n                    break;\n            } \n\n\t\t}, 'json').fail(function( response ){\n            loader.fadeOut('fast');\n            alert('Error deleting review. Retry or contact the plugin support team. Thank You.');\n        });\n\n\t});\n\n\t// Reviews List Shortcode form\n\n\tif( typeof(rwpRlForm) !== 'undefined') {\n\n\t\tvar rlForm = jQuery( rwpRlForm );\n\t\tvar table = rlForm.find('table');\n\t\trlForm.appendTo('body').hide();\n\t\t//console.log(rwpRlForm); \n\t\t\n\t\t// Handles the click event of the submit button\n\t\trlForm.find('#rwp-rl-gen-btn').click(function(e){\n\n\t\t\te.preventDefault();\n\n\t\t\tvar options = $('#rwp-rl-form').serializeArray();\n\n\t\t\tvar shortcode = '[rwp-reviews-list';\n\n\t\t\tvar templates = [];\n\n\t\t\tjQuery.each(options, function(index, opt) {\n\n\t\t\t\t//console.log(opt);\n\n\t\t\t\tswitch( opt.name ) {\n\n\t\t\t\t\tcase 'rwp_rl[title]' :\n\n\t\t\t\t\t\tvar title = $.trim( opt.value );\n\t\t\t\t\t\t\n\t\t\t\t\t\tif( title != '' )\n\t\t\t\t\t\t\tshortcode += ' title=\"' + title + '\"';\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'rwp_rl[template]' :\n\n\t\t\t\t\t\tif( opt.value != '' )\n\t\t\t\t\t\t\ttemplates.push( opt.value );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'rwp_rl[sorting]' :\n\n\t\t\t\t\t\tif( opt.value != 'top_score_users_score')\n\t\t\t\t\t\t\tshortcode += ' sorting=\"' + opt.value + '\"';\n\t\t\t\t\t\t\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'rwp_rl[count]' :\n\n\t\t\t\t\t\tvar count = $.trim( opt.value );\n\n\t\t\t\t\t\tif( count != '' && count != 5 )\n\t\t\t\t\t\t\tshortcode += ' count=\"' + count + '\"';\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'rwp_rl[layout]' :\n\n\t\t\t\t\t\tif( opt.value != 'auto')\n\t\t\t\t\t\t\tshortcode += ' layout=\"' + opt.value + '\"';\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault :\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif( templates.length > 0 ) {\n\t\t\t\t\n\t\t\t\tshortcode += ' template=\"' + templates.join(':') + '\"';\n\t\t\t}\n\n\t\t\tvar starsCheckbox = $('#rwp-rl-form').find('input[name=\"rwp_rl[stars]\"]');\n\n\t\t\tif( starsCheckbox.is(':checked') ) {\n\t\t\t\tshortcode += ' stars=\"yes\"';\n\t\t\t}\n\t\t\t\n\t\t\tshortcode += ']';\n\t\t\t\n\t\t\t// Inserts the shortcode into the active editor\n\t\t\ttinyMCE.activeEditor.insertContent(shortcode);\n\t\t\t\n\t\t\t// Close Thickbox\n\t\t\ttb_remove();\n\t\t});\n\t} \n\n\t// === IO page ===\n\n\t// On action change\n\t$('#rwp-io_action').change(function(){\n\t\t\n\t\tvar action = $(this).val();\n\t\tvar inputFileName = $(this).data('fname');\n\t\tvar submitInput = $('#rwp_io_submit');\n\t\tvar exportLabel = submitInput.data('export');\n\t\tvar importLabel = submitInput.data('import');\n\n\t\t//console.log(inputFileName);\n\n\t\tvar html  = '<tr id=\"rwp-io-file-input\">';\n\t\t\t\thtml += '<th scope=\"row\">File</th>';\n\t\t\t\thtml += '<td>';\n\t\t\t\t\thtml += '<input type=\"file\" name=\"'+ inputFileName +'\" value=\"\" />';\n\t\t\t\thtml += '</td>';\n\t\t\thtml += '</tr>';\n\n\t\tif(action == 'rwp_export') {\n\n\t\t\tsubmitInput.val(exportLabel);\n\t\t\t$('#rwp-io-file-input').remove();\n\n\t\t} else {\n\n\t\t\tsubmitInput.val(importLabel);\n\t\t\t$(this).parent().parent().parent().append(html);\n\t\t}\n\n\t\t//console.log('change');\n\n\t\t// var reviewId = $(this).data('review-id');\n\t\t// var templateId = $(this).val();\n\n\t\t// $('.rwp-t-scores-' + reviewId ).hide();\n\t\t// $('#rwp-template-scores-'+ reviewId +'-'+ templateId).show();\n\t});\n\n\t// === API page ===\n\n\t$('.api h4').click(function(e){\n \t\te.preventDefault();\n \t\tvar content = $(this).parent().find('.api-content');\n \t\tcontent.toggle();\n \t});\n\n \t// === Ratings Page ===\n\n \t/*$('.rwp-ratings-action-edit').click(function(e){\n \t\te.preventDefault();\n \t\tvar action = $(this).data('action');\n \t\tvar metaId = $(this).data('meta-id');\n \t\tvar ratingId = $(this).data('rating-id');\n\n \t\tvar tr = $(this).parent().parent().parent().parent();\n\n\n \t\tconsole.log(metaId);\n\n \t});*/\n\n\t\n\t// Cancel rating editing \n \t$('.reviewer_page_reviewer-users-ratings-page').on('click', '.rwp-rmi-cancel', function(e){\n\n \t\tvar ratingId = $(this).data('rating-id');\n \t\t\n \t\t$('#rwp-tr-r-'+ratingId).fadeOut('fast', function(){\n \t\t\t$(this).remove();\n \t\t});\n\n \t\t$('#rwp-tr-r-a-'+ratingId).fadeIn('fast');\n\n \t});\n \t\n \t// Rating Action\n \t$('#rwp-ratings-mega-wrap').on('click', '.rwp-ratings-action', function(e){\n \t\te.preventDefault();\n \t\tvar action = $(this).data('action');\n \t\tvar metaId = $(this).data('meta-id');\n \t\tvar ratingId = $(this).data('rating-id');\n \t\tvar counterpart = $(this).data('counterpart');\n\n \t\tvar newRating = {};\n \t\tvar loader = $(this).parent().parent().parent().parent().find('.rwp-loader');\n\n \t\tif( action == 'delete' ) {\n\t \t\tvar confirmMsg = $(this).data('confirm-msg');\n\t\t\tvar res = confirm(confirmMsg);\n\n\t\t\tif ( res != true) \n\t\t\t\treturn false;\n\t\t}\n\n\t\tif( action == 'edit-done') {\n\n\t\t\tvar form = $(this).parent();\n\n\t\t\tvar userName = form.find('input[name=\"rwp-rmi[rating_user_name]\"]').val();\n        \tuserName = ( typeof userName === \"undefined\" ) ? '' : userName;\n\n        \tvar email = form.find('input[name=\"rwp-rmi[rating_user_email]\"]').val();\n        \temail = ( typeof email === \"undefined\" ) ? '' : email;\n\n\t\t\tnewRating.rating_user_name \t\t= userName\n\t\t\tnewRating.rating_user_email \t= email;\n\t\t\tnewRating.rating_title \t\t\t= form.find('input[name=\"rwp-rmi[rating_title]\"]').val();\n\t\t\tnewRating.rating_comment \t\t= form.find('textarea[name=\"rwp-rmi[rating_comment]\"]').val();\n\t\t\tnewRating.rating_date \t\t\t= form.find('input[name=\"rwp-rmi[rating_date]\"]').val();\n\t\t\tnewRating.rating_score \t\t\t= [];\n\n\t\t\tform.find('.rwp-scores-sliders input[type=text]').each(function(i){\n\t\t\t\tnewRating.rating_score[$(this).data('index')] = $(this).val();\n\t\t\t});\n\n\t\t\tloader = $(this).parent().find('.rwp-loader');\n\t\t}\n\n \t\t//console.log('action: ' + action + ' | metaId: ' + metaId + ' | ratingId: ' + ratingId );\n\n \t\t\n \t\tvar marker = $(this).parent().parent().parent().parent().find('.rwp-marker');\n\n\t\tvar postData = {\n\t\t\taction: ratingsManagerActionsObj.action,\n\t\t\tsecurity: ratingsManagerActionsObj.ajax_nonce,\n\t\t\tmetaId: metaId,\n\t\t\tratingId: ratingId,\n\t\t\tac: action,\n\t\t\tpending: $(this).data('pending'),\n\t\t\tnewRating: newRating, \n\t\t}\n\n\t\tvar ref = $(this);\n\t\t\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\n\t\t$.post(ratingsManagerActionsObj.ajax_url, postData, function(response){\n\n\t\t\t//console.log(response)\n\n\t\t\tswitch( response.code ) {\n\n                case 400:\n                    loader.fadeOut('fast');\n                    alert(response.data.msg);\n                    break;\n\n                case 200:\n                \tloader.fadeOut('fast');\n\n                \tif( action == 'approve' ) {\n                \t\tmarker.addClass('rwp-hidden');\n                \t\tref.data('action', 'unapprove'); // Action\n                \t\tref.data('counterpart', ref.html()); // Action\n                \t\tref.html(counterpart); // Link value\n                \t\tref.parent().removeClass('rwp_approve').addClass('rwp_unapprove');\n                \t\tref.parent().parent().find('.delete a').data('pending', 'no');\n\n                \t\tref.parent().parent().parent().parent().find('input[name=\"rwp_bulk_action[]\"]').attr('data-pending', 'no');\n                \t\tref.parent().parent().parent().parent().find('input[name=\"rwp_bulk_action[]\"]').data('pending', 'no');\n\n                \t\treturn;\n                \t}\n\n                \tif( action == 'unapprove' ) {\n\t\t\t\t\t\tmarker.removeClass('rwp-hidden');\n                \t\tref.data('action', 'approve'); // Action\n                \t\tref.data('counterpart', ref.html()); // Action\n                \t\tref.html(counterpart); // Link value\n                \t\tref.parent().removeClass('rwp_unapprove').addClass('rwp_approve');\n                \t\tref.parent().parent().find('.delete a').data('pending', 'yes');\n\n                \t\tref.parent().parent().parent().parent().find('input[name=\"rwp_bulk_action[]\"]').attr('data-pending', 'yes');\n                \t\tref.parent().parent().parent().parent().find('input[name=\"rwp_bulk_action[]\"]').data('pending', 'yes');\n\n                \t\treturn;\n                \t}\n\n                \tif( action == 'delete' ) {\n                \t\tref.parent().parent().parent().parent().remove();\n                \t\treturn;\n                \t}\n\n                \tif( action == 'edit' ) {\n                \t\t//console.log(response);\n                \t\tvar tr \t\t= ref.parent().parent().parent().parent();\n                \t\tvar rating \t= response.data.rating;\n                \t\tvar form \t= response.data.form;\n\n                \t\ttr.attr('id', 'rwp-tr-r-a-'+ratingId);\n                \t\ttr.hide();\n                \t\t$(form).insertBefore(tr).fadeIn('fast');\n                \t\t\n                \t\ttrigRatingsSliders('#rwp-tr-r-'+ratingId);\n                \t}\n\n                \tif( action == 'edit-done') {\n                \t\tvar tr \t\t= $('#rwp-tr-r-a-'+ratingId);\n                \t\tvar rating \t= response.data.rating;\n\n                \t\t//console.log(rating);\n                \t\tif( rating.rating_user_id < 1 ) {\n                \t\t\ttr.find('.rwp-rt-user-name').html( rating.rating_user_name );\n                \t\t\ttr.find('.rwp_rt_author a').html( rating.rating_user_email );\n                \t\t}\n                \t\ttr.find('.rwp_rt_comment .rwp-the-comment').html( rating.rating_title );\n                \t\ttr.find('.rwp_rt_comment p').html( rating.rating_comment );\n                \t\ttr.find('.rwp_rt_comment em').html( 'Submitted on ' + rating.rating_date );\n                \t\ttr.find('.rwp_rt_score').find('p').remove();\n                \t\ttr.find('.rwp_rt_score').append('<p class=\"description\">Refresh the page to see the scores update</p>');\n\n                \t\t$('#rwp-tr-r-'+ratingId).fadeOut('fast', function(){\n\t\t\t\t \t\t\t$(this).remove();\n\t\t\t\t \t\t});\n\n\t\t\t\t \t\ttr.fadeIn('fast');\n                \t}\n\n                    break;\n\n                default:\n                    //console.log(response);\n                    //alert('Error in rating process!');\n                    break;\n            } \n        \n        }, 'json').fail(function( response ){\n            loader.fadeOut('fast');\n            alert('Error during action!');\n        });\n\n \t});\n\n\tfunction trigRatingsSliders(scope) {\n\n\t\t\tvar step \t\t= ( typeof rwpPreferences.preferences_step !== \"undefined\" ) ? parseFloat(rwpPreferences.preferences_step) : .5;\n\t\t\tvar decimals \t= getDecimals(step);\n\t\t\tvar elem \t\t= $(scope).find('.rwp-slider');\n\n\t\t\t$(elem).each(function(i){\n\n\t\t\t\t$(this).noUiSlider({\n\t\t            step: step,\n\t\t            start: $(this).data('val'),\n\t\t            connect: \"lower\",\n\t\t            range: {\n\t\t              'min': $(this).data('min'),\n\t\t              'max': $(this).data('max')\n\t\t            },\n\t\t            format: wNumb({\n\t\t                decimals: decimals,\n\t\t            })\n\t\t        });\n\n\t\t        $(this).Link('lower').to($(this).parent().find('input'), null, wNumb({decimals: decimals }));\n\t\t    });\n\t\t}\n\n\t$('#rwp-ratings-mega-wrap #doaction, #rwp-ratings-mega-wrap #doaction2').click(function(e){\n\t\te.preventDefault();\n\n\t\tvar form = $(this).parent().parent().parent();\n\t\tvar rows = [];\n        var inputs = form.find('input[name=\"rwp_bulk_action[]\"]:checked');\n        var action = $(this).parent().find('select').val();\n\n        if( inputs.length != 0 && action != -1 ) {\n\n            inputs.each(function(i){\n                var obj = {};\n                obj.metaId \t\t= $(this).data('meta-id');\n                obj.ratingId \t= $(this).data('rating-id');\n                obj.pending \t= $(this).data('pending');\n                rows.push( obj );\n            });\n        } else {\n        \treturn;\n        }\n\n        if( action == 'delete' ) {\n\t \t\tvar confirmMsg = 'Confirm the action?';\n\t\t\tvar res = confirm(confirmMsg);\n\n\t\t\tif ( res != true) \n\t\t\t\treturn false;\n\t\t}\n\n        var postData = {\n\t\t\taction: ratingsManagerActionsBulkObj.action,\n\t\t\tsecurity: ratingsManagerActionsBulkObj.ajax_nonce,\n\t\t\trows: rows,\n\t\t\tac: action,\n\t\t}\n\n\t\tvar src = $('#rwp-ratings-mega-wrap .rwp-loader').first().attr('src');\n\t\t$('#rwp-ratings-mega-wrap .bulkactions img').remove();\n\t\t$('#rwp-ratings-mega-wrap .bulkactions').append('<img style=\"margin-top:6px; display:none;\" src=\"'+ src +'\" alt=\"\" />');\n\n\t\tvar loader = $('#rwp-ratings-mega-wrap .bulkactions img');\n\n\n\t\t\n\t\t// Show loader\n\t\tloader.fadeIn('fast');\n\n\t\t$.post(ratingsManagerActionsBulkObj.ajax_url, postData, function(response){\n\n\t\t\t//console.log(response)\n\n\t\t\tswitch( response.code ) {\n\n                case 400:\n                    loader.fadeOut('fast');\n                    alert(response.data.msg);\n                    break;\n\n                case 200:\n                \tloader.fadeOut('fast');\n                \tlocation.reload();\n\n                default:\n\n                \tbreak;\n            } \n        \n        }, 'json').fail(function( response ){\n            loader.fadeOut('fast');\n            alert('Error during bulk action!');\n        });\n\n\t});\n\t\n});"],"sourceRoot":"/source/"}