jQuery(document).ready(function(t){function e(t){var e=parseFloat(t),a=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return a?Math.max(0,(a[1]?a[1].length:0)-(a[2]?+a[2]:0)):0}function a(){t(".rwp-slider-std").each(function(e){t(this).noUiSlider({step:1,start:t(this).data("val"),connect:"lower",range:{min:t(this).data("min"),max:t(this).data("max")},format:wNumb({decimals:0})}),t(this).Link("lower").to(t(this).parent().find("input"),null,wNumb({decimals:0}))})}function r(){t(".rwp-slider-limits").each(function(e){var a=t(this).data("min"),r=t(this).data("max");r="inf"==r?1e4:r,t(this).noUiSlider({connect:!0,step:1,start:[a,r],range:{min:[0],"90%":5e3,max:1e4},format:wNumb({decimals:0})}),t(this).Link("lower").to(t(this).parent().find("input.rwp-min"),null,wNumb({decimals:0})),t(this).Link("upper").to(t(this).parent().find("input.rwp-max"),null,wNumb({decimals:0})),t(this).on({slide:function(){var e=(t(this).val()[0],t(this).val()[1]);e>5e3&&t(this).parent().find("input.rwp-max").val("no-limit")}}),r>5e3&&t(this).parent().find("input.rwp-max").val("no-limit")})}function n(t){var e=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return e.test(t)}function i(e){t(".rwp-t-scores-"+e).first().show(),t(".rwp-t-custom-tabs-"+e).first().show()}function p(e){t("#rwp-reviews-meta-box .rwp-tabs-wrap").children("li").each(function(e){t(this).removeClass("rwp-tabs")}),t("#rwp-review-tab-"+e).addClass("rwp-tabs"),t("#rwp-reviews-wrap").children(".rwp-review-form").each(function(e){t(this).hide()}),t("#rwp-review-"+e).show()}function s(a){var r="undefined"!=typeof rwpPreferences.preferences_step?parseFloat(rwpPreferences.preferences_step):.5,n=e(r),i=null==a?".rwp-slider":"#rwp-review-"+a+" .rwp-slider";t(i).each(function(e){t(this).noUiSlider({step:r,start:t(this).data("val"),connect:"lower",range:{min:t(this).data("min"),max:t(this).data("max")},format:wNumb({decimals:n})}),t(this).Link("lower").to(t(this).parent().find("input"),null,wNumb({decimals:n}))})}function o(e){t(".rwp-t-reviews-"+e).first().show()}function l(e){t("#rwp-tables-meta-box .rwp-tabs-wrap").children("li").each(function(e){t(this).removeClass("rwp-tabs")}),t("#rwp-table-tab-"+e).addClass("rwp-tabs"),t("#rwp-tables-wrap").children(".rwp-table-form").each(function(e){t(this).hide()}),t("#rwp-table-"+e).show()}function d(a){var r="undefined"!=typeof rwpPreferences.preferences_step?parseFloat(rwpPreferences.preferences_step):.5,n=e(r),i=t(a).find(".rwp-slider");t(i).each(function(e){t(this).noUiSlider({step:r,start:t(this).data("val"),connect:"lower",range:{min:t(this).data("min"),max:t(this).data("max")},format:wNumb({decimals:n})}),t(this).Link("lower").to(t(this).parent().find("input"),null,wNumb({decimals:n}))})}var c=document.getElementById("rwp-codemirror");if(null!==c){CodeMirror.fromTextArea(c,{lineNumbers:!0,lineWrapping:!0,theme:"neo",value:c.value,indentUnit:4,indentWithTabs:!0})}if(t("#rwp-add-criteria-btn").click(function(e){e.preventDefault();var a=t("#rwp-criterias"),r=a.data("placeholder"),n=a.data("remove-label"),i=a.find("li").length,p='<li><span class="dashicons dashicons-menu"></span><input type="text" name="rwp_templates[template_criterias]['+i+']" value="" placeholder="'+r+'" /> <a class="rwp-remove-criteria-btn" href="#">'+n+"</a></li>";t("#rwp-criterias").append(p)}),t(".wrap").on("click",".rwp-remove-criteria-btn",function(e){e.preventDefault(),t(this).parent().remove()}),t("#rwp-add-custom-tab-btn").click(function(e){e.preventDefault();var a=t("#rwp-custom-tabs"),r=a.find("li").last(),n=a.data("ajax"),i=0;0!=r.length&&(i=parseInt(r.data("i"))+1),console.log(r);var p="";p+='<li data-i="'+i+'">',t.each(n.formFields,function(t,e){var a=a="tab_color"==e?'class="rwp-color-picker"':"";p+="<span>",p+="<label>"+n.options[e].label+"</label>",p+='<input type="text" name="'+n.optionName+"["+n.fieldId+"]["+i+"]["+e+']" value="" placeholder="'+n.options[e]["default"]+'" '+a+" />",p+="</span>"}),p+='<span><a class="rwp-remove-tab-btn" href="#">'+n.removeLabel+"</a></span>",p+="</li>",a.append(p),t(".rwp-color-picker").wpColorPicker()}),t(".wrap").on("click",".rwp-remove-tab-btn",function(e){e.preventDefault(),t(this).parent().parent().remove()}),t(".rwp-color-picker").wpColorPicker(),t("#rwp-criterias").sortable(),t(".wrap").on("change",".rwp-exclude-terms input",function(e){e.preventDefault();var a=t(this).closest("ul"),r=a.find("input").length,n=a.find("input:checked").length,i=a.parent().find(".rwp-terms-msg"),p=a.data("msg");i.html(""),r==n&&(t(this).attr("checked",!1),i.html(p))}),null!=t("#rwp-pref-form")&&(r(),a()),t("#rwp-notification-btn").click(function(e){e.preventDefault();var a=t.trim(t(this).parent().find("input[type=text]").val());if(0==a.length||!n(a))return alert("Insert a valid email address"),!1;var r=t(this).parent().find(".rwp-loader"),i={action:demoNotificationDataObj.action,security:demoNotificationDataObj.ajax_nonce,email:a};r.fadeIn("fast"),t.post(demoNotificationDataObj.ajax_url,i,function(t){r.fadeOut("fast"),alert(t.data.msg)},"json").fail(function(){r.fadeOut("fast"),alert("Error sending email. Retry or contact the plugin support team. Thank You.")})}),null!=t("#rwp-reviews-meta-box")&&s(null),t("#rwp-reviews-meta-box").on("change",".rwp-template-selection",function(){var e=t(this).data("review-id"),a=t(this).val();t(".rwp-t-scores-"+e).hide(),t("#rwp-template-scores-"+e+"-"+a).show(),t(".rwp-t-custom-tabs-"+e).hide(),t("#rwp-custom-tabs-"+e+"-"+a).show()}),t("#rwp-reviews-meta-box").on("click",".rwp-tabs-wrap li a",function(e){e.preventDefault();var a=t(this).data("review-id");p(a)}),t("#rwp-reviews-meta-box").on("click",".rwp-delete-review-btn",function(e){e.preventDefault();var a=t(this).data("review-id");t("#rwp-review-"+a).remove(),t("#rwp-review-tab-"+a).remove();var r=t(".rwp-review-form").last().data("review-id");p(r)}),t("#rwp-reviews-meta-box").on("click",".rwp-review-remove-image-btn",function(e){e.preventDefault();var a=t(this).data("review-id"),r=t(this).data("default");t("#rwp-review-image-img-"+a).attr("src",r),t("#rwp-review-add-image-input-"+a).val("")}),t("#rwp-add-review-form-btn").click(function(e){e.preventDefault();var a=0,r=t("#rwp-reviews-meta-box .rwp-tabs-wrap").data("placehoder"),n=t(".rwp-review-form").last().data("review-id"),o=t(this).parent().find(".rwp-loader"),l=t(this).parent().find("select[name=rwp-review-type]").val();null!=n&&(a=parseInt(n)+1);var d={action:reviewsMetaBoxObj.action,security:reviewsMetaBoxObj.ajax_nonce,rwp_review_id:a,rwp_review_type:l};o.fadeIn("fast"),t.post(reviewsMetaBoxObj.ajax_url,d,function(e){t("#rwp-reviews-wrap").append(e),t("#rwp-reviews-meta-box .rwp-tabs-wrap").append('<li class="rwp-tabs" id="rwp-review-tab-'+a+'"><a href="#" data-review-id="'+a+'">'+r+" "+a+"</a></li>"),i(a),p(a),o.fadeOut("fast"),s(a)}).fail(function(){o.fadeOut("fast"),alert("Error getting review form. Retry or contact the plugin support team. Thank You.")})}),t("#rwp-reviews-meta-box").on("click",".rwp-add-custom-link-btn",function(e){e.preventDefault();var a=(t(this).data("review-id"),0),r=t(this).parent().find("li").last().data("id");null!=r&&(a=parseInt(r)+1);var n=t(this).parent().find(".rwp-custom-links"),i='<li data-id="'+a+'">';i+='<input type="text" name="rwp_reviews[0][review_custom_links]['+a+'][label]"	value="" placeholder="'+n.data("label-placeholder")+'">',i+='<input type="text" name="rwp_reviews[0][review_custom_links]['+a+'][url]" 	value="" placeholder="'+n.data("url-placeholder")+'">',i+='<a href="#" class="rwp-delete-custom-link-btn">'+n.data("remove-placeholder")+"</a>",i+="</li>",n.append(i)}),t("#rwp-reviews-meta-box").on("click",".rwp-delete-custom-link-btn",function(e){e.preventDefault(),t(this).parent().remove()}),t("#rwp-reviews-meta-box").on("keyup",".rwp-review-title-input",function(e){e.preventDefault();var a=t(this).data("review-id"),r=t(this).data("default"),n=t(this).val(),i=""==n?r:n;t("#rwp-review-tab-"+a+" a").html(i)}),t("#rwp-tables-meta-box").on("change",".rwp-template-selection",function(){var e=t(this).data("table-id"),a=t(this).val();t(".rwp-t-reviews-"+e).hide(),t("#rwp-template-reviews-"+e+"-"+a).show()}),t("#rwp-tables-meta-box").on("click",".rwp-tabs-wrap li a",function(e){e.preventDefault();var a=t(this).data("table-id");l(a)}),t("#rwp-tables-meta-box").on("click",".rwp-delete-table-btn",function(e){e.preventDefault();var a=t(this).data("table-id");t("#rwp-table-"+a).remove(),t("#rwp-table-tab-"+a).remove();var r=t(".rwp-table-form").last().data("table-id");l(r)}),t("#rwp-add-table-form-btn").click(function(e){e.preventDefault();var a=0,r=t("#rwp-tables-meta-box .rwp-tabs-wrap").data("placehoder"),n=t(".rwp-table-form").last().data("table-id"),i=t(this).parent().find(".rwp-loader");null!=n&&(a=parseInt(n)+1);var p={action:tablesMetaBoxObj.action,security:tablesMetaBoxObj.ajax_nonce,rwp_table_id:a};i.fadeIn("fast"),t.post(tablesMetaBoxObj.ajax_url,p,function(e){t("#rwp-tables-wrap").append(e),t("#rwp-tables-meta-box .rwp-tabs-wrap").append('<li class="rwp-tabs" id="rwp-table-tab-'+a+'"><a href="#" data-table-id="'+a+'">'+r+"</a></li>"),o(a),l(a),i.fadeOut("fast")}).fail(function(){i.fadeOut("fast"),alert("Error getting table form. Retry or contact the plugin support team. Thank You.")})}),t("#rwp-tables-meta-box").on("keyup",".rwp-table-title-input",function(e){e.preventDefault();var a=t(this).data("table-id"),r=t(this).data("default"),n=t(this).val(),i=""==n?r:n;t("#rwp-table-tab-"+a+" a").html(i)}),t(".rwp-theme-name").tooltip({track:!0,tooltipClass:"rwp-tooltip",content:function(){return'<img src="'+t(this).data("preview")+'" height="400px" />'}}),t("#rwp-rating-image-btn-default").click(function(e){e.preventDefault();var a=t(this).data("default");t("#rwp-rating-image-url").val(a),t("#rwp-rating-image").attr("src",a)}),t(".themes").on("click",".rwp-delete-template-btn",function(e){e.preventDefault();var a=t(this).data("template-id"),r=t(this).data("confirm-msg"),n=confirm(r);if(1!=n)return!1;var i=t(".wrap").find(".rwp-loader"),p={action:deleteTemplateObj.action,security:deleteTemplateObj.ajax_nonce,templateId:a};i.fadeIn("fast"),t.post(deleteTemplateObj.ajax_url,p,function(e){t("#rwp-theme-wrap-"+a).fadeOut("fast",function(){t(this).remove()}),i.fadeOut("fast")},"json").fail(function(){i.fadeOut("fast"),alert("Error deleting template. Retry or contact the plugin support team. Thank You.")})}),t(".themes").on("click",".rwp-duplicate-template-btn",function(e){e.preventDefault();var a=t(this).data("template-id"),r=t(".wrap").find(".rwp-loader"),n={action:duplicateTemplateObj.action,security:duplicateTemplateObj.ajax_nonce,templateId:a};r.fadeIn("fast"),t.post(duplicateTemplateObj.ajax_url,n,function(e){if("undefined"!=typeof e.html){var a=t(".theme.add-new-theme"),n=t(".themes");a.remove(),n.append(e.html).append(a)}r.fadeOut("fast")},"json").fail(function(){r.fadeOut("fast"),alert("Error duplicating template. Retry or contact the plugin support team. Thank You.")})}),t("#rwp-restore-data-btn").click(function(e){e.preventDefault();var a=t(this).data("confirm-msg"),r=confirm(a);if(1!=r)return!1;var n=t(this).parent().find(".rwp-loader"),i={action:restoreDataObj.action,security:restoreDataObj.ajax_nonce};n.fadeIn("fast"),t.post(restoreDataObj.ajax_url,i,function(e){t("#rwp-restore-data-notification p strong").html(e.msg),t("#rwp-restore-data-notification").slideDown("fats"),n.fadeOut("fast")},"json").fail(function(){n.fadeOut("fast"),alert("Error restoring data. Retry or contact the plugin support team. Thank You.")})}),t(".rwp-reset-score-btn").click(function(e){e.preventDefault();var a=t(this).data("confirm-msg"),r=t(this).data("res-msg"),n=t(this).data("review-id"),i=t(this).data("post-id"),p=confirm(a),s=t(this);if(1!=p)return!1;var o=t(this).parent().find(".rwp-loader"),l={action:resetScoreObj.action,security:resetScoreObj.ajax_nonce,reviewId:n,postId:i};o.fadeIn("fast"),t.post(resetScoreObj.ajax_url,l,function(t){s.parent().parent().find(".rwp_reviews_table_review_users_score").html(r),o.fadeOut("fast")}).fail(function(){o.fadeOut("fast"),alert("Error resetting score. Retry or contact the plugin support team. Thank You.")})}),t(".rwp-delete-single-review-btn").click(function(e){e.preventDefault();var a=t(this).data("confirm-msg"),r=t(this).data("res-msg"),n=t(this).data("review-id"),i=t(this).data("post-id"),p=confirm(a),s=t(this);if(1!=p)return!1;var o=t(this).parent().find(".rwp-loader"),l={action:deleteReviewObj.action,security:deleteReviewObj.ajax_nonce,reviewId:n,postId:i};o.fadeIn("fast"),t.post(deleteReviewObj.ajax_url,l,function(t){switch(o.fadeOut("fast"),t.code){case 400:o.fadeOut("fast"),alert(t.data.msg);break;case 200:s.parent().parent().remove(),alert(r);break;default:alert("Error in deleting process!")}},"json").fail(function(t){o.fadeOut("fast"),alert("Error deleting review. Retry or contact the plugin support team. Thank You.")})}),"undefined"!=typeof rwpRlForm){var f=jQuery(rwpRlForm);f.find("table");f.appendTo("body").hide(),f.find("#rwp-rl-gen-btn").click(function(e){e.preventDefault();var a=t("#rwp-rl-form").serializeArray(),r="[rwp-reviews-list",n=[];jQuery.each(a,function(e,a){switch(a.name){case"rwp_rl[title]":var i=t.trim(a.value);""!=i&&(r+=' title="'+i+'"');break;case"rwp_rl[template]":""!=a.value&&n.push(a.value);break;case"rwp_rl[sorting]":"top_score_users_score"!=a.value&&(r+=' sorting="'+a.value+'"');break;case"rwp_rl[count]":var p=t.trim(a.value);""!=p&&5!=p&&(r+=' count="'+p+'"');break;case"rwp_rl[layout]":"auto"!=a.value&&(r+=' layout="'+a.value+'"')}}),n.length>0&&(r+=' template="'+n.join(":")+'"');var i=t("#rwp-rl-form").find('input[name="rwp_rl[stars]"]');i.is(":checked")&&(r+=' stars="yes"'),r+="]",tinyMCE.activeEditor.insertContent(r),tb_remove()})}t("#rwp-io_action").change(function(){var e=t(this).val(),a=t(this).data("fname"),r=t("#rwp_io_submit"),n=r.data("export"),i=r.data("import"),p='<tr id="rwp-io-file-input">';p+='<th scope="row">File</th>',p+="<td>",p+='<input type="file" name="'+a+'" value="" />',p+="</td>",p+="</tr>","rwp_export"==e?(r.val(n),t("#rwp-io-file-input").remove()):(r.val(i),t(this).parent().parent().parent().append(p))}),t(".api h4").click(function(e){e.preventDefault();var a=t(this).parent().find(".api-content");a.toggle()}),t(".reviewer_page_reviewer-users-ratings-page").on("click",".rwp-rmi-cancel",function(e){var a=t(this).data("rating-id");t("#rwp-tr-r-"+a).fadeOut("fast",function(){t(this).remove()}),t("#rwp-tr-r-a-"+a).fadeIn("fast")}),t("#rwp-ratings-mega-wrap").on("click",".rwp-ratings-action",function(e){e.preventDefault();var a=t(this).data("action"),r=t(this).data("meta-id"),n=t(this).data("rating-id"),i=t(this).data("counterpart"),p={},s=t(this).parent().parent().parent().parent().find(".rwp-loader");if("delete"==a){var o=t(this).data("confirm-msg"),l=confirm(o);if(1!=l)return!1}if("edit-done"==a){var c=t(this).parent(),f=c.find('input[name="rwp-rmi[rating_user_name]"]').val();f="undefined"==typeof f?"":f;var u=c.find('input[name="rwp-rmi[rating_user_email]"]').val();u="undefined"==typeof u?"":u,p.rating_user_name=f,p.rating_user_email=u,p.rating_title=c.find('input[name="rwp-rmi[rating_title]"]').val(),p.rating_comment=c.find('textarea[name="rwp-rmi[rating_comment]"]').val(),p.rating_date=c.find('input[name="rwp-rmi[rating_date]"]').val(),p.rating_score=[],c.find(".rwp-scores-sliders input[type=text]").each(function(e){p.rating_score[t(this).data("index")]=t(this).val()}),s=t(this).parent().find(".rwp-loader")}var w=t(this).parent().parent().parent().parent().find(".rwp-marker"),m={action:ratingsManagerActionsObj.action,security:ratingsManagerActionsObj.ajax_nonce,metaId:r,ratingId:n,ac:a,pending:t(this).data("pending"),newRating:p},v=t(this);s.fadeIn("fast"),t.post(ratingsManagerActionsObj.ajax_url,m,function(e){switch(e.code){case 400:s.fadeOut("fast"),alert(e.data.msg);break;case 200:if(s.fadeOut("fast"),"approve"==a)return w.addClass("rwp-hidden"),v.data("action","unapprove"),v.data("counterpart",v.html()),v.html(i),v.parent().removeClass("rwp_approve").addClass("rwp_unapprove"),v.parent().parent().find(".delete a").data("pending","no"),v.parent().parent().parent().parent().find('input[name="rwp_bulk_action[]"]').attr("data-pending","no"),void v.parent().parent().parent().parent().find('input[name="rwp_bulk_action[]"]').data("pending","no");if("unapprove"==a)return w.removeClass("rwp-hidden"),v.data("action","approve"),v.data("counterpart",v.html()),v.html(i),v.parent().removeClass("rwp_unapprove").addClass("rwp_approve"),v.parent().parent().find(".delete a").data("pending","yes"),v.parent().parent().parent().parent().find('input[name="rwp_bulk_action[]"]').attr("data-pending","yes"),void v.parent().parent().parent().parent().find('input[name="rwp_bulk_action[]"]').data("pending","yes");if("delete"==a)return void v.parent().parent().parent().parent().remove();if("edit"==a){var r=v.parent().parent().parent().parent(),p=e.data.rating,o=e.data.form;r.attr("id","rwp-tr-r-a-"+n),r.hide(),t(o).insertBefore(r).fadeIn("fast"),d("#rwp-tr-r-"+n)}if("edit-done"==a){var r=t("#rwp-tr-r-a-"+n),p=e.data.rating;p.rating_user_id<1&&(r.find(".rwp-rt-user-name").html(p.rating_user_name),r.find(".rwp_rt_author a").html(p.rating_user_email)),r.find(".rwp_rt_comment .rwp-the-comment").html(p.rating_title),r.find(".rwp_rt_comment p").html(p.rating_comment),r.find(".rwp_rt_comment em").html("Submitted on "+p.rating_date),r.find(".rwp_rt_score").find("p").remove(),r.find(".rwp_rt_score").append('<p class="description">Refresh the page to see the scores update</p>'),t("#rwp-tr-r-"+n).fadeOut("fast",function(){t(this).remove()}),r.fadeIn("fast")}}},"json").fail(function(t){s.fadeOut("fast"),alert("Error during action!")})}),t("#rwp-ratings-mega-wrap #doaction, #rwp-ratings-mega-wrap #doaction2").click(function(e){e.preventDefault();var a=t(this).parent().parent().parent(),r=[],n=a.find('input[name="rwp_bulk_action[]"]:checked'),i=t(this).parent().find("select").val();if(0!=n.length&&-1!=i){if(n.each(function(e){var a={};a.metaId=t(this).data("meta-id"),a.ratingId=t(this).data("rating-id"),a.pending=t(this).data("pending"),r.push(a)}),"delete"==i){var p="Confirm the action?",s=confirm(p);if(1!=s)return!1}var o={action:ratingsManagerActionsBulkObj.action,security:ratingsManagerActionsBulkObj.ajax_nonce,rows:r,ac:i},l=t("#rwp-ratings-mega-wrap .rwp-loader").first().attr("src");t("#rwp-ratings-mega-wrap .bulkactions img").remove(),t("#rwp-ratings-mega-wrap .bulkactions").append('<img style="margin-top:6px; display:none;" src="'+l+'" alt="" />');var d=t("#rwp-ratings-mega-wrap .bulkactions img");d.fadeIn("fast"),t.post(ratingsManagerActionsBulkObj.ajax_url,o,function(t){switch(t.code){case 400:d.fadeOut("fast"),alert(t.data.msg);break;case 200:d.fadeOut("fast"),location.reload()}},"json").fail(function(t){d.fadeOut("fast"),alert("Error during bulk action!")})}})});