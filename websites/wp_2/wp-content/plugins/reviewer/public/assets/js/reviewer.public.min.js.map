{"version":3,"sources":["public-reviewer.public.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"reviewer.public.min.js","sourcesContent":["/**\n * Reviewer Plugin v.3\n * Created by Michele Ivani\n */\n\nfunction rwpReCaptchaLoad() {\n    var siteKey, id, rc;\n    jQuery('.rwp-recaptcha').each(function(i){\n        siteKey = jQuery(this).data('sitekey');\n        id = jQuery(this).attr('id');\n        rc = grecaptcha.render(id, {\n          'sitekey' : siteKey\n        });\n        jQuery('#' + id).data('grcid', rc);\n    });\n}\n\n(function( $ ) {\n'use strict';\n$(function() {\n\n    // Trig Sliders\n    if ( $('.rwp-scores-sliders').length > 0) {\n        trigSliders();\n    }\n\n    // Knob\n    if( $('.rwp-knob').length > 0) {\n        trigKnob();   \n    }\n\n    // Knob\n    if( $('.rwp-knob-table').length > 0) {\n        trigTableKnob();   \n    }\n\n    // var urid = getQueryParam('rwpurid');\n    // if( urid !== false ) {\n    //     $(document).scrollTop( ($('#'+urid).offset().top - 10) );\n    // }\n\n    // Submit User Review\n    $('.rwp-submit-ur').click(function(e){\n        e.preventDefault();\n\n        var ref = $(this);\n\n        var form        = $(this).parent().parent();\n        var reviewId    = form.find('input[name=\"rwp-ur[review-id]\"]').val();\n        var postId      = form.find('input[name=\"rwp-ur[post-id]\"]').val();\n        var userId      = form.find('input[name=\"rwp-ur[user-id]\"]').val();\n        var mode        = form.find('input[name=\"rwp-ur[mode]\"]').val();\n        var template    = form.find('input[name=\"rwp-ur[template]\"]').val();\n\n        var userName = form.find('input[name=\"rwp-ur[name]\"]').val();\n        userName = ( typeof userName === \"undefined\" ) ? '' : userName;\n\n        var title = form.find('input[name=\"rwp-ur[review_title]\"]').val();\n        title = ( typeof title === \"undefined\" ) ? '' : title;\n\n        var comment = form.find('textarea[name=\"rwp-ur[comment]\"]').val();\n        comment = ( typeof comment === \"undefined\" ) ? '' : comment;\n\n        var captchaId = '#rwp-recaptcha-' + postId + '-' + reviewId;\n        var captchaEl = form.find(captchaId);\n        var captcha     = ( captchaEl.length <= 0 ) ? false : grecaptcha.getResponse( captchaEl.data('grcid') );\n        var recaptchaid = ( captchaEl.length <= 0 ) ? null :  captchaEl.data('grcid');\n        var email = form.find('input[name=\"rwp-ur[email]\"]').val();\n        email = ( typeof email === \"undefined\" ) ? '' : email;\n\n        var scores;\n\n        switch( mode ) {\n\n            case 'five_stars' : // 5 Stars rating\n\n                var stars = form.find('input.rwp-rating:checked').val();\n                scores = ( typeof stars === \"undefined\" ) ? 0 : stars;\n                break;\n\n            case 'full_five_stars': // 5 Stars full rating\n\n                scores = [];\n                var sliders = form.find('input.rwp-rating:checked');\n\n                if( sliders.length != 0 ) {\n\n                    sliders.each(function(i){\n                        var obj = {};\n                        obj.i = $(this).data('index');\n                        obj.val = $(this).val();\n\n                        scores.push( obj );\n                    });\n                }\n                break;\n\n            default: // Sliders full rating\n\n                scores = [];\n                var sliders = form.find('.rwp-slider');\n\n                if( sliders.length != 0 ) {\n\n                    sliders.each(function(i){\n                        var obj = {};\n                        obj.i = $(this).data('index');\n                        obj.val = $(this).val();\n\n                        scores.push( obj );\n                    });\n                }\n                break;\n        }\n\n        var postData = {\n            action: reviewerRatingObj.action,\n            security: reviewerRatingObj.ajax_nonce,\n            review_id: reviewId,\n            post_id: postId,\n            scores: scores,\n            user_id: userId, \n            user_name: userName,\n            user_email: email,\n            title: title,\n            comment: comment,\n            method: mode,\n            template: template,\n            captcha: captcha\n        }\n\n        var loader = form.find('.rwp-loader');\n        loader.fadeIn('fast');\n\n        $.post(reviewerRatingObj.ajax_url, postData, function(response) {\n\n            //console.log(response);\n\n            var notification = form.find('.rwp-notification');\n            notification.html('');\n\n            switch( response.code ) {\n\n                case 405:\n\n                    loader.fadeOut('fast');\n                    $.each(response.data, function(i,v) {\n                        notification.append( v + '<br/>')\n                    });\n                    if(response.captcha) {\n                        grecaptcha.reset(recaptchaid);\n                    }\n                    break;\n\n                case 400:\n\n                    loader.fadeOut('fast');\n                    notification.html(response.data.msg);\n                    break;\n\n                case 401:\n\n                    loader.fadeOut('fast');\n                    notification.html(response.data.msg);\n                    if(response.data.captcha) {\n                        grecaptcha.reset(recaptchaid);\n                    }\n                    break;\n\n                case 200:\n\n                    notification.addClass('rwp-success')\n                    notification.html(response.data.msg);\n                    //form.slideUp(500);\n\n                    var branch = form.find('input[name=\"rwp-ur[branch]\"]').val();\n                    branch = ( typeof branch === \"undefined\" ) ? false : true;\n\n                    if( !branch ) {\n\n                        $.ajax({\n                            url: \"\",\n                            cache: false,\n                            context: document.body,\n                            success: function(s,x){\n                                loader.fadeOut('fast');\n\n                                var newPage    = $(s);\n                                var newReview  = newPage.find('#rwp-review-'+postId+'-'+reviewId + ' .rwp-review');\n\n                                var container   = form.parent().parent().parent().parent();\n\n                                container.find('.rwp-review').remove();\n                                container.hide().append(newReview).fadeIn('fast');\n\n                                if( container.find('.rwp-knob').length > 0) {\n                                    trigKnob();   \n                                }\n                            }\n                        });\n                    \n                    } else {\n\n                        setTimeout(function() {\n                               location.reload();\n                        }, 1000);\n                    }\n                    break;\n\n                case 201: \n\n                    loader.fadeOut('fast');\n                    notification.addClass('rwp-success');\n                    notification.html(response.data.msg);\n\n                    var not = ref.parent();\n                    not.find('input').remove();\n                    var wrap = $('#rwp-ratings-form-'+ postId +'-'+reviewId);\n                    wrap.find('.rwp-ratings-form').slideUp('fast');\n                    wrap.append(not);\n\n                default:\n                    //console.log(response);\n                    //alert('Error in rating process!');\n                    break;\n            } \n        \n        }, 'json').fail(function( response ){\n            loader.fadeOut('fast');\n            alert('Error during rating process!');\n        });\n\n    });\n\n\n    // Submit User Like\n    // $('.rwp-review-wrap').on('click', '.rwp-on .rwp-like span, .rwp-on .rwp-dislike span', function(e){\n    //     e.preventDefault();\n\n    //     var ratingId    = $(this).data('rating-id');\n    //     var postId      = $(this).data('post-id');\n    //     var method      = $(this).data('method');\n    //     var userId      = $(this).data('user-id');\n\n    //     var form        = $(this).parent().parent();\n\n    //     var postData = {\n    //         action: reviewerLikeObj.action,\n    //         security: reviewerLikeObj.ajax_nonce,\n    //         rating_id: ratingId,\n    //         post_id: postId,\n    //         user_id: userId,\n    //         method: method\n    //     }\n\n    //     var loader  = form.find('.rwp-loader');\n    //     loader.fadeIn('fast');\n    //     var count   = $(this).parent().find('em');\n\n    //     $.post(reviewerLikeObj.ajax_url, postData, function(response) {\n\n    //         //console.log(response);\n\n    //         loader.fadeOut('fast');\n\n    //         switch( response.code ) {\n\n    //             case 400:\n    //                 alert(response.data.msg);\n    //                 break;\n\n    //             case 200:\n                    \n    //                 var countVal = ( method == 'like' ) ? response.data.like : response.data.dislike ;\n    //                 count.html(countVal);\n\n    //                 form.removeClass('rwp-on').addClass('rwp-off');\n    //                 break;\n\n    //             default:\n    //                 //console.log(response);\n    //                 alert('Error in like/dislike process!'); \n    //                 break;\n    //         }\n\n    //     }, 'json').fail(function( response ){\n    //         loader.fadeOut('fast');\n    //         alert('Error during like/dislike process!');\n    //     });\n\n    // });\n\n    // More Ratings\n    // $('.rwp-review-wrap').on('click', '.rwp-show-more', function(e){\n    //     // var perPage = parseInt($(this).data('per-page'));\n    //     // var ratings = $(this).parent().find('.rwp-users-reviews .rwp-user-review.rwp-hidden');\n\n    //     // for (var i = 0; i < perPage; i++) {\n    //     //     $(ratings[i]).removeClass('rwp-hidden');\n    //     // }\n\n    //     // ratings = $(this).parent().find('.rwp-users-reviews .rwp-user-review.rwp-hidden');\n\n    //     // if(ratings.length <= 0) \n    //     //     $(this).remove()\n\n    //     var pages = $(this).parent().find('.rwp-users-reviews-page.rwp-hidden');\n    //         if ( ( pages.length - 1 ) <= 0 ) {\n    //             $(this).fadeOut('fast', function(){\n    //                 $(this).remove();\n    //             });\n    //         }\n    //         pages.first().removeClass('rwp-hidden');\n    // });\n\n    // Refresh captcha\n    // $('.rwp-refresh-captcha-btn').click(function(e){\n    //     e.preventDefault();\n\n    //     var reviewId    = $(this).data('review-id');\n    //     var postId      = $(this).data('post-id');\n\n\n    //     var postData = {\n    //         action: rwpCaptchaObj.action,\n    //         security: rwpCaptchaObj.ajax_nonce,\n    //         review_id: reviewId,\n    //         post_id: postId\n    //     }\n\n    //     var form = $(this).parent();\n\n\n    //     $.post(rwpCaptchaObj.ajax_url, postData, function(response) {\n\n    //         //console.log(response);\n\n    \n    //         switch( response.code ) {\n\n    //             case 400:\n    //                 alert(response.data.msg);\n    //                 break;\n\n    //             case 200:\n                    \n    //                 form.find('.rwp-captcha-image').attr('src', response.captcha);\n    //                 form.find('.rwp-captcha-input').val('');\n    //                 break;\n\n    //             default:\n    //                 //console.log(response);\n    //                 alert('Error in like/dislike process!'); \n    //                 break;\n    //         }\n\n    //     }, 'json').fail(function( response ){\n    //         loader.fadeOut('fast');\n    //         alert('Error Refreshing Captcha');\n    //     });\n\n    // });\n\n    // Share Dialog\n    // $('.rwp-review-wrap').on('click', '.rwp-share.rwp-d', function(e){\n    //     e.preventDefault();\n    //     var viewportH = $( window ).height(),\n    //         viewportW = $( window ).width(),\n    //         url = $(this).attr('href');\n\n    //     if ( viewportW <= 768 ) { // Mobile\n    //         window.open(url);\n    //     } else {\n    //         var W = 670,\n    //             H = 360,\n    //             T = ( viewportH - H ) / 2,\n    //             L = ( viewportW - W ) / 2;\n    //         window.open(url, '_blank', 'height='+ H +', width='+ W +', top='+ T +', left='+ L +', menubar=no, resizable=yes, scrollbars=yes, status=no, titlebar=no, toolbar=no');\n    //     }\n    // });\n\n    // Share Prompt\n    // $('.rwp-review-wrap').on('click', '.rwp-share.rwp-sharing-link', function(e){\n    //     e.preventDefault();\n    //     var res = prompt( $(this).data('label'), $(this).attr('href') );\n    // });\n\n    function getQueryParam(parm) {\n       var query = window.location.search.substring(1);\n       var vars = query.split(\"&\");\n       for (var i=0;i<vars.length;i++) {\n               var pair = vars[i].split(\"=\");\n               if(pair[0] == parm){return pair[1];}\n       }\n       return(false);\n    }\n\n    \n\n    function trigKnob() {\n        \n        $('.rwp-knob').knob({\n            readOnly: true,\n            thickness: .2, \n            width: 100,\n            height: 100,\n            bgColor: '#e5e5e5',\n            inputColor: '#3b3c3e',\n            fontWeight: 'bold' \n        });\n    }\n\n    function trigTableKnob() {\n        \n        $('.rwp-knob-table').knob({\n            readOnly: true,\n            thickness: .25, \n            width: 50,\n            height: 50,\n            bgColor: '#e5e5e5',\n            inputColor: '#3b3c3e',\n            fontWeight: 'bold',\n            inline: false\n            \n        });\n    }\n\n    function trigSliders() {\n        \n        var decimals;\n        \n        $('.rwp-slider').each(function(i){\n\n            decimals = getDecimals($(this).data('step'));\n            \n            $(this).noUiSlider({\n                step: $(this).data('step'),\n                start: $(this).data('val'),\n                connect: \"lower\",\n                range: {\n                  'min': $(this).data('min'),\n                  'max': $(this).data('max')\n                },\n                format: wNumb({\n                    decimals: decimals,\n                })\n            });\n\n            $(this).Link('lower').to($(this).parent().find('input'), null, wNumb({decimals: decimals }));\n        });\n    }\n\n    function getDecimals(number) {\n        var num = parseFloat(number);\n        var match = ('' + num).match(/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/);\n        if (!match)\n            return 0;\n        return Math.max(0, (match[1] ? match[1].length : 0) - (match[2] ? +match[2] : 0));\n    }\n\n});\n})( jQuery );\n"],"sourceRoot":"/source/"}